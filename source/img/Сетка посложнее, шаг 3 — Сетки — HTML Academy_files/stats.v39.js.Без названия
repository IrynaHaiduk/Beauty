!function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=398)}({1:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.querySelector=function(t,e){if((0,i.isString)(t)){var n=[t,document];e=n[0],t=n[1]}return t.querySelector(e)},e.querySelectorAll=function(t,e){if((0,i.isString)(t)){var n=[t,document];e=n[0],t=n[1]}return t.querySelectorAll(e)};var i=n(2)},11:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.request=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new XMLHttpRequest;n.open(e.method||"get",t),(0,i.isFunction)(e.success)||(e.success=s.dummy);(0,i.isFunction)(e.failure)||(e.failure=s.dummy);if(e.headers)for(var r in e.headers)e.headers.hasOwnProperty(r)&&n.setRequestHeader(r,e.headers[r]);n.addEventListener("readystatechange",function(){4===n.readyState&&(200===n.status?e.success(n.responseText,n.status):e.failure(n.responseText,n.status))}),n.send(e.data||null)};var i=n(2),s=n(12)},12:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dummy=function(){}},2:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isFunction=function(t){return"function"==typeof t},e.isString=function(t){return"string"==typeof t},e.isArray=function(t){return Array.isArray(t)},e.isTouchDevice=function(){return"ontouchstart"in window||"DocumentTouch"in window&&document instanceof DocumentTouch},e.isDesktop=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:768;return window.matchMedia("(min-width: "+t+"px )").matches}},398:function(t,e,n){t.exports=n(399)},399:function(t,e,n){"use strict";var i=n(11),s={COURSE_TASK:1,BLOG_TASK:2,PERFORMANCE:3},r={init:function(t){var e=this,n=t.apiUrl,i=t.token,s=t.startTime,r=t.uniqId,o=t.userId,a=t.minEventsCnt,u=t.minSendTime;this._apiUrl=n,this._token=i,this._expiresIn=i?1e3*JSON.parse(atob(/\.(.*?)\./.exec(i)[1])).exp:Date.now(),this._userId=Number.parseInt(o,10),this._uniqId=r,this._defaultMinEventsCnt=a?Number.parseInt(a,10):20,this._defaultMinSendTime=u?1e3*Number.parseInt(u,10):2e4,this._minEventsCnt=this._defaultMinEventsCnt,this._minSendTime=this._defaultMinSendTime,this._startAt=Date.now(),this._serverStartTime=s?1e3*Number.parseInt(s,10):this._startAt,this._timeDiff=this._serverStartTime-this._startAt,this._storageKey="task-stats."+Date.now()+String(Math.random()).slice(2),this._lastSentAt=this._startAt,this._sendingNow=!1,this._unloadingNow=!1,this._listeners={},this._eventLog=[],window.addEventListener("pagehide",function(){return e._onUnload()}),window.addEventListener("unload",function(){return e._onUnload()});try{var d=Object.keys(localStorage).filter(function(t){return t.startsWith("task-stats")});if(d.length){var h,c=d.map(function(t){return JSON.parse(localStorage.getItem(t))}).reduce(function(t,e){return t.concat.apply(t,e)},[]);(h=this._eventLog).unshift.apply(h,c),this._keepStats(!0),d.forEach(function(t){return localStorage.removeItem(t)})}}catch(t){}this._exploreProp("haStats")},add:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.defer,i=e.force;this._logEvent(t),n||this._keepStats(i)},on:function(t,e){this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)},_emit:function(t){this._listeners[t]&&this._listeners[t].forEach(function(t){return t()})},_exploreProp:function(t){var e=this;window[t]&&(window[t].on&&Array.isArray(window[t].on.q)&&window[t].on.q.forEach(function(t){return e.on.apply(e,t)}),window[t].add&&Array.isArray(window[t].add.q)&&window[t].add.q.forEach(function(t){return e.add.apply(e,t)}))},_logEvent:function(t){var e=t.type,n=t.eventTime;delete t.eventTime;var i=Object.assign({},t,{type:s[e],event_time:this._normalizeTS(n),uniq_id:this._uniqId,user_id:this._userId,url:location.href});this._eventLog.push(i),this._storeEventLog()},_keepStats:function(t){var e=this;if(this._shouldSendEventLog(t)){this._sendingNow=!0;var n=JSON.stringify({events:this._eventLog,token:this._token}),s=this._eventLog.length;if(!(!this._unloadingNow||!navigator.sendBeacon||!navigator.sendBeacon(this._apiUrl,n)))return void this._handleSent(!0,200,s);(0,i.request)(this._apiUrl,{method:"POST",headers:{"Content-Type":"text/plain; charset=utf-8"},data:n,success:function(t,n){return e._handleSent(!0,n,s)},failure:function(t,n){return e._handleSent(!1,n)}})}},_shouldSendEventLog:function(t){if(this._isSendingForbidden)return!1;if(performance.now()+this._serverStartTime>this._expiresIn-1e4)return!1;var e=this._eventLog.length;return!(this._sendingNow||!e)&&(t||Date.now()-this._lastSentAt>this._minSendTime||e>=this._minEventsCnt)},_handleSent:function(t,e,n){this._sendingNow=!1,t?(this._lastSentAt=Date.now(),this._eventLog=this._eventLog.slice(n),this._storeEventLog(),this._minSendTime=this._defaultMinSendTime,this._minEventsCnt=this._defaultMinEventsCnt):401===e?this._isSendingForbidden=!0:(this._minSendTime=Date.now()-this._lastSentAt+this._defaultMinSendTime,this._minEventsCnt=this._eventLog.length+this._defaultMinEventsCnt)},_onUnload:function(){this._unloadingNow||"prerender"===document.visibilityState||(this._unloadingNow=!0,this._isSendingForbidden=!0,this._emit("unload"),this._isSendingForbidden=!1,this._keepStats(!0))},_storeEventLog:function(){try{this._eventLog.length?localStorage.setItem(this._storageKey,JSON.stringify(this._eventLog)):localStorage.removeItem(this._storageKey)}catch(t){}},_normalizeTS:function(t){return Math.floor((t+this._timeDiff)/1e3)}},o=(0,n(1).querySelector)("#ha-stats-script"),a=o?o.dataset:{};r.init(a),window.haStats=r}});